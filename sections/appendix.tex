%%%
% File: /latex/big-cocluster-paper/sections/appendix.tex
% Created Date: Tuesday, January 23rd 2024
% Author: Zihan
% -----
% Last Modified: Wednesday, 27th March 2024 10:40:18 pm
% Modified By: the developer formerly known as Zihan at <wzh4464@gmail.com>
% -----
% HISTORY:
% Date      		By   	Comments
% ----------		------	---------------------------------------------------------
%%%

% \newpage
\appendix

\begin{theorem}
    \label{thm:probability_co_cluster_detection}
    If the matrix $\mathbf{A}$ is partitioned into $m \times n$ blocks, each with sizes $\phi_i \times \psi_j$, and the probability of failing to detect co-cluster $\mathbf{C}_k$ in any block is $P(\omega_k)$, then
    \begin{equation}
        \begin{split}
            P(\omega_k) & \le \exp \left\{ -2 [\phi m (s^{(k)})^2 + \psi n (t^{(k)})^2] \right\}
        \end{split}
    \end{equation}
    Given $T_p$ times of random sampling, the probability of detecting the co-cluster $C_k$ is
    \begin{equation}
        \begin{split}
            P & = 1 - P(\omega_k)^{T_p}                                                        \\
              & \ge 1 - \exp \left\{ -2 T_p [\phi m (s^{(k)})^2 + \psi n (t^{(k)})^2] \right\}
        \end{split}
    \end{equation}

\end{theorem}

\begin{proof}
    Consider co-cluster $C_k$,
    % P(M_{(i,j)}^{(k)} = i)
    \begin{equation}
        \begin{split}
            P(M_{(i,j)}^{(k)} = \alpha) & = \frac{\binom{M^{(k)}}{\alpha} \binom{M-M^{(k)}}{\phi_i-\alpha}}{\binom{M}{\phi_i}} \\
            % p[x_] := Binomial[Mk, a] * Binomial[M-Mk, P-a] / Binomial[M, P]
            P(N_{(i,j)}^{(k)} = \beta)  & = \frac{\binom{N^{(k)}}{\beta} \binom{N-N^{(k)}}{\psi_j-\beta}}{\binom{N}{\psi_j}}
            % q[y_] := Binomial[Nk, b] * Binomial[N-Nk, Q-b] / Binomial[N, Q]
        \end{split}
    \end{equation}
    The tail probability of $M_{(i,j)}^{(k)}$ and $N_{(i,j)}^{(k)}$ are
    \begin{equation}
        \begin{split}
            P(M_{(i,j)}^{(k)} < T_m) & = \sum_{\alpha=1}^{T_m-1} P(M_{(i,j)}^{(k)} = \alpha) \\
                                     & \le \exp(-2 (s_i^{(k)})^2 \phi_i)
        \end{split}
    \end{equation}
    where $s_i^{(k)} = \cfrac{M^{(k)}}{M}-\cfrac{T_m-1}{\phi_i}$, and
    \begin{equation}
        \begin{split}
            % &\le \sum_{\alpha=1}^{T_m-1} \frac{\binom{M^{(k)}}{\alpha} \binom{M-M^{(k)}}{\phi_i-\alpha}}{\binom{M}{\phi_i}} \\
            P(N_{(i,j)}^{(k)} < T_n) & = \sum_{\beta=1}^{T_n-1} P(N_{(i,j)}^{(k)} = \beta) \\
                                     & \le \exp (-2 (t_j^{(k)})^2 \psi_j)
        \end{split}
    \end{equation}
    where $t_j^{(k)} = \cfrac{N^{(k)}}{N}-\cfrac{T_n-1}{\psi_j}$.

    The joint probability of $M_{(i,j)}^{(k)}$ and $N_{(i,j)}^{(k)}$ are
    \begin{equation}
        \begin{split}
            P & (M_{(i,j)}^{(k)} < T_m, N_{(i,j)}^{(k)} < T_n)              \\ & = \sum_{\alpha=1}^{T_m-1} \sum_{\beta=1}^{T_n-1} P(M_{(i,j)}^{(k)} = \alpha) P(N_{(i,j)}^{(k)} = \beta) \\
            % pq[x_, y_] := Sum[p[a] * q[b], {a, 1, x-1}, {b, 1, y-1}]
              & \le \exp[-2 (s_i^{(k)})^2 \phi_i + -2 (t_j^{(k)})^2 \psi_j]
        \end{split}
    \end{equation}
    If $\phi_i = p$ and $\psi_j = q$ for all $i$ and $j$, then

    Suppose event $\omega_k$ is that co-cluster $C_k$ can't be find in any block $B_{(i,j)}$, then
    \begin{equation}
        \begin{split}
            P(\omega_k) & = \prod_{i=1}^m \prod_{j=1}^n P(M_{(i,j)}^{(k)} < T_m, N_{(i,j)}^{(k)} < T_n)                          \\
                        & \le \prod_{i=1}^m \prod_{j=1}^n \exp\{-2 \left[ (s_i^{(k)})^2 \phi_i + (t_j^{(k)})^2 \psi_j \right] \} \\
                        & = \exp\{-2 \sum_{i=1}^m \sum_{j=1}^n \left[ (s_i^{(k)})^2 \phi_i + (t_j^{(k)})^2 \psi_j \right] \}     \\
        \end{split}
    \end{equation}

    If $\phi_i = \phi$ and $\psi_j = \psi$ for all $i$ and $j$, then
    \begin{equation}
        \begin{split}
            s_i^{(k)} & = s^{(k)} = \frac{M^{(k)}}{M}-\frac{T_m-1}{\phi} \\
            t_j^{(k)} & = t^{(k)} = \frac{N^{(k)}}{N}-\frac{T_n-1}{\psi}
        \end{split}
    \end{equation}

    \begin{equation}
        \begin{split}
            P(\omega_k) & \le \exp \left\{ -2 [\phi m (s^{(k)})^2 + \psi n (t^{(k)})^2] \right\} \\
        \end{split}
    \end{equation}


    And if we do $T_p$ times of random sampling, the Probability of detecting the co-cluster is
    \begin{equation}
        \begin{split}
            P & = 1 - P(\omega_k)^{T_p}                                                        \\
              & \ge 1 - \exp \left\{ -2 T_p [\phi m (s^{(k)})^2 + \psi n (t^{(k)})^2] \right\} \\
        \end{split}
    \end{equation}
    according to which, we can set $m, n, \phi, \psi, T_m, T_n$ and $T_p$ to ensure the probability of detecting the co-cluster is larger than a given threshold.
\end{proof}